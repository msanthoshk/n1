<div class="list import-history-list">
    <div id="title-bar">
        <div class="display">
            <div class="col" class="page-title-bar" *ngIf="(isMobile && !isSearchFocused) || !isMobile">
                <!-- <span class="pi pi-arrow-left back-action"></span> -->
                <span class="page-title" [innerHTML]="pageViewTitle | translate"></span>
            </div>
            <div class="w-100" *ngIf="showBreadcrumb">
                <app-breadcrumb></app-breadcrumb>
            </div>
            <app-action-bar [buttons]="leftActionBarConfig.children" (onBtnClick)='actionBarAction($event)'
                [style.order]="isMobile?'1':'0'" [isRowSelected]="isRowSelected" [isChildListpage]="isChildPage"
                [isListPage]="isList" [detailConditionalButtons]="conditionalActions">
            </app-action-bar>
            <app-action-bar [buttons]="rightActionBarConfig.children" (onBtnClick)='actionBarAction($event)'
                [style.order]="isMobile?'1':'0'" [isRowSelected]="isRowSelected" [isChildListpage]="isChildPage"
                [isListPage]="isList" [detailConditionalButtons]="conditionalActions">
            </app-action-bar>
            <div class="p-0" id="search-container" [ngStyle]="{'width':isMobile && isSearchFocused? '100%':'50%' }">
                <div *ngIf="!isMobile" class="col global-search p-3">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text show-advanced">
                                <span class="pi pi-search icon-font"></span>
                            </span>
                        </div>
                        <input type="text" class="form-control" pInputText [placeholder]="'Search' | translate"
                            (keydown)="onKeydown($event)" [(ngModel)]="filter.globalSearch" />
                        <div class="input-group-append ">
                            <span class="input-group-text show-advanced cursor-pointer">
                                <span (click)="toggleAdvancedSearch()" class="advancedsearch-icon" #toggleButton
                                    *ngIf="tableSearchConfig.showAdvancedSearch">
                                    <span class="icon-filter">
                                        <svg class="filter-icon">
                                            <use xlink:href="../../../../assets/images/filter.svg#filter-button"></use>
                                        </svg>
                                    </span>
                                </span>
                            </span>
                        </div>
                    </div>
                </div>

                <div class="d-flex" *ngIf="isMobile">
                    <div *ngIf="isMobile" class="search-mobile-container col global-search">
                        <button class="pi pi-search icon-font search-btn1" (click)="focus()"></button>
                        <!-- <span>{{isSearchFocused}}</span> -->
                        <input placeholder='Search' id="mobile-search-icon" class='js-search open' type="text"
                            (keydown)="onKeydown($event)" [(ngModel)]="filter.globalSearch"
                            [ngClass]="{'open':isSearchFocused}">
                        <!-- <span [ngClass]="{'search-close':!isSearchFocused}" class="pi pi-times icon-font " style="right:50px" (click)="clearFilters()"></span> -->
                    </div>
                    <div class="input-group-append" *ngIf="!isSearchFocused && tableSearchConfig.showAdvancedSearch">
                        <span class="input-group-text pi pi-sliders-h icon-font px-3 py-3 cursor-pointer"
                            (click)="toggleAdvancedSearch()" #toggleButton></span>
                    </div>
                    <div class="input-group-append" *ngIf="isSearchFocused">
                        <span class="input-group-text pi pi-times icon-font px-3 py-3 cursor-pointer"
                            (click)="clearFilters()"></span>
                    </div>
                </div>

                <div class="advanced-search ev-detail-view"
                    *ngIf="(tableSearchConfig.showAdvancedSearch && showAdvancedSearch)" #menu>
                    <span class="pr-3 pt-0 adv-search-header" [innerHTML]="'Advanced Search'| translate"></span>
                    <span style="float:right" class="cursor-pointer"><i class="pi pi-times"
                            (click)="toggleAdvancedSearch()"></i></span>
                    <form [formGroup]="tableSearchControls" (ngSubmit)="advancedSearch()" class="ev-form">
                        <div class="row form-body">
                            <div class="form-row vg-col-2">
                                <div class="form-col" [hidden]="hiddenFields.modelName" id="modelName">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.modelName?.isRequired, 'error':inValidFields.modelName}">
                                        <label for="modelName" class="col-form-label modelName-label"
                                            [textContent]=" 'TABLE_NAME'|translate "></label>
                                        <span class="info-bubble" *ngIf="tableSearchFieldConfig?.modelName?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.modelName?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <input type="text" pInputText class="form-control" formControlName="modelName"
                                            [placeholder]="tableSearchFieldConfig?.modelName?.placeHolder || ''"
                                            [maxlength]="tableSearchFieldConfig?.modelName?.maxLength" />
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.modelName?.helpText || ''}}</div>
                                    </div>
                                </div>
                                <div class="form-col" [hidden]="hiddenFields.templateName" id="templateName">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.templateName?.isRequired, 'error':inValidFields.templateName}">
                                        <label for="templateName" class="col-form-label templateName-label"
                                            [textContent]=" 'TEMPLATE_NAME'|translate "></label>
                                        <span class="info-bubble" *ngIf="tableSearchFieldConfig?.templateName?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.templateName?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <input type="text" pInputText class="form-control" formControlName="templateName"
                                            [placeholder]="tableSearchFieldConfig?.templateName?.placeHolder || ''"
                                            [maxlength]="tableSearchFieldConfig?.templateName?.maxLength" />
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.templateName?.helpText || ''}}</div>
                                    </div>
                                </div>
                                <div class="form-col" [hidden]="hiddenFields.createdDate" id="createdDate">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.createdDate?.isRequired, 'error':inValidFields.createdDate}">
                                        <label for="createdDate"
                                            class="col-form-label dateTime-label createdDate-label"
                                            [textContent]="'INITIATED_TIME'|translate"></label>
                                        <span class="info-bubble"
                                            *ngIf="tableSearchFieldConfig?.createdDate?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.createdDate?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <p-calendar showButtonBar="true" class="form-input w-100"
                                            formControlName="createdDate" [showIcon]="true"
                                            inputId="datetimerangepicker" [showTime]="true" selectionMode="range"
                                            [minDate]="tableSearchFieldConfig?.createdDate?.calendarMinDate"
                                            [maxDate]="tableSearchFieldConfig?.createdDate?.calendarMaxDate"
                                            appendTo="body"
                                            [placeholder]="tableSearchFieldConfig?.createdDate?.placeHolder || ''"
                                            [dateFormat]="dateFormat"></p-calendar>
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.createdDate?.helpText || ''}}</div>
                                    </div>
                                </div>
                                <div class="form-col" [hidden]="hiddenFields.createdBy" id="createdBy">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.createdBy?.isRequired, 'error':inValidFields.createdBy}">
                                        <label for="createdBy" class="col-form-label createdBy-label"
                                            [textContent]=" 'INITIATED_BY'|translate "></label>
                                        <span class="info-bubble"
                                            *ngIf="tableSearchFieldConfig?.createdBy?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.createdBy?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <input type="text" pInputText class="form-control" formControlName="createdBy"
                                            [placeholder]="tableSearchFieldConfig?.createdBy?.placeHolder || ''"
                                            [maxlength]="tableSearchFieldConfig?.createdBy?.maxLength" />
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.createdBy?.helpText || ''}}</div>
                                    </div>
                                </div>
                                <div class="form-col" [hidden]="hiddenFields.importStatus" id="importStatus">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.importStatus?.isRequired, 'error':inValidFields.importStatus}">
                                        <label for="importStatus" class="col-form-label importStatus-label"
                                            [textContent]=" 'STATUS'|translate "></label>
                                        <span class="info-bubble" *ngIf="tableSearchFieldConfig?.importStatus?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.importStatus?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <input type="text" pInputText class="form-control" formControlName="importStatus"
                                            [placeholder]="tableSearchFieldConfig?.importStatus?.placeHolder || ''"
                                            [maxlength]="tableSearchFieldConfig?.importStatus?.maxLength" />
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.importStatus?.helpText || ''}}</div>
                                    </div>
                                </div>
                                <div class="form-col" [hidden]="hiddenFields.completedTime" id="completedTime">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.completedTime?.isRequired, 'error':inValidFields.completedTime}">
                                        <label for="completedTime"
                                            class="col-form-label dateTime-label completedTime-label"
                                            [textContent]="'COMPLETED_TIME'|translate"></label>
                                        <span class="info-bubble"
                                            *ngIf="tableSearchFieldConfig?.completedTime?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.completedTime?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <p-calendar showButtonBar="true" class="form-input w-100"
                                            formControlName="completedTime" [showIcon]="true"
                                            inputId="datetimerangepicker" [showTime]="true" selectionMode="range"
                                            [minDate]="tableSearchFieldConfig?.completedTime?.calendarMinDate"
                                            [maxDate]="tableSearchFieldConfig?.completedTime?.calendarMaxDate"
                                            appendTo="body"
                                            [placeholder]="tableSearchFieldConfig?.completedTime?.placeHolder || ''"
                                            [dateFormat]="dateFormat"></p-calendar>
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.completedTime?.helpText || ''}}</div>
                                    </div>
                                </div>
                                <div class="form-col" [hidden]="hiddenFields.attachmentId" id="attachmentId">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.attachmentId?.isRequired, 'error':inValidFields.attachmentId}">
                                        <label for="attachmentId" class="col-form-label attachmentId-label"
                                            [textContent]=" 'UPLOADED_FILE'|translate "></label>
                                        <span class="info-bubble"
                                            *ngIf="tableSearchFieldConfig?.attachmentId?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.attachmentId?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <input type="text" pInputText class="form-control"
                                            formControlName="attachmentId"
                                            [placeholder]="tableSearchFieldConfig?.attachmentId?.placeHolder || ''"
                                            [maxlength]="tableSearchFieldConfig?.attachmentId?.maxLength" />
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.attachmentId?.helpText || ''}}</div>
                                    </div>
                                </div>
                                <div class="form-col" [hidden]="hiddenFields.fileType" id="fileType">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.fileType?.isRequired, 'error':inValidFields.fileType}">
                                        <label for="fileType" class="col-form-label fileType-label"
                                            [textContent]=" 'SOURCE_FILE_TYPE'|translate "></label>
                                        <span class="info-bubble"
                                            *ngIf="tableSearchFieldConfig?.fileType?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.fileType?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <input type="text" pInputText class="form-control"
                                            formControlName="fileType"
                                            [placeholder]="tableSearchFieldConfig?.fileType?.placeHolder || ''"
                                            [maxlength]="tableSearchFieldConfig?.fileType?.maxLength" />
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.fileType?.helpText || ''}}</div>
                                    </div>
                                </div>
                                <div class="form-col" [hidden]="hiddenFields.dateFormat" id="dateFormat">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.dateFormat?.isRequired, 'error':inValidFields.dateFormat}">
                                        <label for="dateFormat" class="col-form-label dateFormat-label"
                                            [textContent]=" 'INPUT_DATE_FORMAT'|translate "></label>
                                        <span class="info-bubble"
                                            *ngIf="tableSearchFieldConfig?.dateFormat?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.dateFormat?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <input type="text" pInputText class="form-control"
                                            formControlName="dateFormat"
                                            [placeholder]="tableSearchFieldConfig?.dateFormat?.placeHolder || ''"
                                            [maxlength]="tableSearchFieldConfig?.dateFormat?.maxLength" />
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.dateFormat?.helpText || ''}}</div>
                                    </div>
                                </div>
                                <div class="form-col" [hidden]="hiddenFields.numberFormat" id="numberFormat">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.numberFormat?.isRequired, 'error':inValidFields.numberFormat}">
                                        <label for="numberFormat" class="col-form-label numberFormat-label"
                                            [textContent]=" 'INPUT_NUMBER_FORMAT'|translate "></label>
                                        <span class="info-bubble"
                                            *ngIf="tableSearchFieldConfig?.numberFormat?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.numberFormat?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <input type="text" pInputText class="form-control"
                                            formControlName="numberFormat"
                                            [placeholder]="tableSearchFieldConfig?.numberFormat?.placeHolder || ''"
                                            [maxlength]="tableSearchFieldConfig?.numberFormat?.maxLength" />
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.numberFormat?.helpText || ''}}</div>
                                    </div>
                                </div>
                                <div class="form-col" [hidden]="hiddenFields.batchSize"
                                    id="batchSize" formGroupName="batchSize">
                                    <div class="field-row"
                                        [ngClass]="{'required': tableSearchFieldConfig?.batchSize?.isRequired}">
                                        <label for="tableSearchFieldConfig"
                                            class=" col-form-label batchSize-label"
                                            [textContent]="'NUMBER_OF_RECORDS_IMPORTED'|translate"></label>
                                        <span class="info-bubble"
                                            *ngIf="tableSearchFieldConfig?.batchSize?.infoBubble"
                                            [pTooltip]="tableSearchFieldConfig?.batchSize?.infoBubble || ''"><i
                                                class="fa fa-circle-info"></i></span>
                                        <div class="d-flex range w-100">
                                            <div class="p-inputgroup mr-2">
                                                <span class="p-inputgroup-addon px-3">{{'FROM' | translate}}</span>
                                                <p-inputNumber class="form-input" formControlName="min"
                                                    [placeholder]="tableSearchFieldConfig?.batchSize?.placeHolder || ''"
                                                    [showButtons]="tableSearchFieldConfig?.batchSize?.showButtons"
                                                    [suffix]="tableSearchFieldConfig?.batchSize?.suffix"
                                                    [min]="tableSearchFieldConfig?.batchSize?.minVal"
                                                    [max]="tableSearchFieldConfig?.batchSize?.maxVal">
                                                </p-inputNumber>
                                            </div>
                                            <div class="p-inputgroup">
                                                <span class="p-inputgroup-addon px-3">{{'TO' | translate}}</span>
                                                <p-inputNumber class="form-input" formControlName="max"
                                                    [placeholder]="tableSearchFieldConfig?.batchSize?.placeHolder || ''"
                                                    [showButtons]="tableSearchFieldConfig?.batchSize?.showButtons"
                                                    [suffix]="tableSearchFieldConfig?.batchSize?.suffix"
                                                    [min]="tableSearchFieldConfig?.batchSize?.minVal"
                                                    [max]="tableSearchFieldConfig?.batchSize?.maxVal">
                                                </p-inputNumber>
                                            </div>
                                        </div>
                                        <div class="fst-italic fs-5 help-text">
                                            {{tableSearchFieldConfig?.batchSize?.helpText || ''}}</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="search-actions">
                            <div>
                                <button type="button" class="btn btn-secondary search-btn"
                                    (click)="clearFilterValues()">Clear
                                    Filter</button>
                            </div>
                            <div>
                                <div class="btn-group mr-0" role="group">
                                    <button type="button" class="btn btn-secondary search-btn"
                                        (click)="toggleAdvancedSearch()">Cancel</button>
                                    <button type="submit"
                                        class="btn btn-primary search-btn search-btn-primary">Search</button>
                                </div>
                            </div>
                        </div>

                    </form>
                </div>
            </div>
        </div>
    </div>

    <app-grid [gridConfig]="gridConfig" *ngIf="gridConfig"
        [ngClass]="this.tableConfig.viewAs === 'card' ? 'gridsterList' : ''" class="{{tableConfig.tableStyle}}">
    </app-grid>

</div>

<p-dialog header="Import error details" [(visible)]="displayErrorDet" [modal]="true"
    [style]="{width: '50vw', height:'20vw', 'font-family': 'Poppins'}" [draggable]="false" [resizable]="false"
    class="ev-detail-view">
    <app-import-error-details [errId]="this.errId"></app-import-error-details>
</p-dialog>

<p-dialog header="Add Import" [(visible)]="displayImport" [modal]="true"
    [style]="{width: '45vw', height:'40vw', 'font-family': 'Poppins'}" [draggable]="false" [resizable]="false"
    class="ev-detail-view import-dialog-box">
    <app-import-page [fromListPage]="false"></app-import-page>
</p-dialog>